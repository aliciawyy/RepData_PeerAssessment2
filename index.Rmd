Analysis of Storm in the United States
======================================

## Abstract
In this report, we will analyze the impact of the storm on *population health* and its *economic consequences* with the data from 1950 till 2011 in the U.S. National Oceanic and Atmospheric Administration's (NOAA) storm database. To decide which type of event is most harmful to the population health, we will use the estimates of fatalities and injuries, as the histogram shows in the end, **tornado** causes the largest number of fatalities and injuries and also has the greatest economic consequences.

## Introduction

Storms and other severe weather events can cause both public health and economic problems for communities and municipalities. Many severe events can result in fatalities, injuries, and property damage, and preventing such outcomes to the extent possible is a key concern.

This project involves exploring the U.S. National Oceanic and Atmospheric Administration's (NOAA) storm database. This database tracks characteristics of major storms and weather events in the United States, including when and where they occur, as well as estimates of any fatalities, injuries, and property damage.

## Data Processing
The full dataset of this study can be downloaded at the address https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2 . First let's load the data and take a look at its structure summary

```{r cache = TRUE}
storm <- read.csv("repdata-data-StormData.csv", sep = ",")
str(storm)
```
The events in the database start in the year 1950 and end in November 2011. In the earlier years of the database there are generally fewer events recorded, most likely due to a lack of good records. More recent years should be considered more complete.

We will first load the libraries needed for this study
```{r}
library(plyr)
library(ggplot2)
library(gridExtra)
```

### Population Health
To study which type of storm is most harmful to the population health, we can take a look at the number of fatalities and injuries caused by different types of storm.

As we have in total **`r nrow(storm)`** obsevations, we can first arrange the data and only take the **20** first most serious types of stors. The data processing is as following

```{r cache = TRUE}
fatalities <- aggregate(x = storm$FATALITIES, by = list(storm$EVTYPE), FUN = sum)
names(fatalities) <- c("EVTYPE", "FATALITIES")
fatalities <- arrange(fatalities, FATALITIES, decreasing = TRUE)
fatalities <- head(fatalities, n = 20)
fatalities <- within(fatalities, EVTYPE <- factor(x = EVTYPE, levels = fatalities$EVTYPE))

injuries <- aggregate(x = storm$INJURIES, by = list(storm$EVTYPE), FUN = sum)
names(injuries) <- c("EVTYPE", "INJURIES")
injuries <- arrange(injuries, INJURIES, decreasing = TRUE)
injuries <- head(injuries, n = 20)
injuries <- within(injuries, EVTYPE <- factor(x = EVTYPE, levels = injuries$EVTYPE))
```

### Economic Consequences

We will use the property damage to estimate the impact of different types of storms on economy.
```{r cache = TRUE}
property <- aggregate(x = storm$PROPDMG, by = list(storm$EVTYPE), FUN = sum)
names(property) <- c("EVTYPE", "PROPDMG")
property <- arrange(property, PROPDMG, decreasing = TRUE)
property <- head(property, n = 20)
property <- within(property, EVTYPE <- factor(x = EVTYPE, levels = property$EVTYPE))
```

## Results
With the data we obtained about concerning the *population health*, now we can take a look at the two lists
```{r}
fatalities
injuries
```

```{r, fig.width = 10}
plot1 <- qplot(EVTYPE, data = fatalities, weight = FATALITIES, geom = "bar", binwidth = 1) + 
    scale_y_continuous("FATALITIES") +
    theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
     xlab("Event Type") + ggtitle("Total Fatalities by Event Type in the U.S.")

plot2 <- qplot(EVTYPE, data = injuries, weight = INJURIES, geom = "bar", binwidth = 1) + 
    scale_y_continuous("INJURIES") +
    theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
    xlab("Event Type") + ggtitle("Total Injuries by Event Type in the U.S.")
grid.arrange(plot1, plot2, ncol = 2)
```
According to the histograms above, we note that the **tornado** is the most harmful for the population health as it causes the largest number of fatalities and injuries. In addition, as we note that **excessive heat**, **flash flood**, **heat** and **lightning** also cause much larger number of fatality and injury than the other types of storm, we should also pay attention to these events.

The top impact of storms on the propery damage is as following
```{r}
property
```

```{r, fig.width = 8}
qplot(EVTYPE, data = property, weight = PROPDMG, geom = "bar", binwidth = 1) + 
    scale_y_continuous("Property Damage") +
    theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
     xlab("Event Type") + ggtitle("Total Property Damage by Event Type in the U.S.")
```
As shown in the histogram, **tornado** has the greatest economic impact among all types of storm event.



